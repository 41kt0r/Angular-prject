{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/core/services/posts.service\";\nimport * as i2 from \"src/app/core/services/auth.service\";\nimport * as i3 from \"@angular/platform-browser\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nfunction DetailsComponent_div_0_ng_container_11_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"a\", 13);\n    i0.ɵɵlistener(\"click\", function DetailsComponent_div_0_ng_container_11_div_2_Template_a_click_1_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r5.postLike(ctx_r5.car._id));\n    });\n    i0.ɵɵtext(2, \" Like \");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction DetailsComponent_div_0_ng_container_11_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"a\", 14);\n    i0.ɵɵtext(2, \" You have already liked this post! \");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction DetailsComponent_div_0_ng_container_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\");\n    i0.ɵɵtemplate(2, DetailsComponent_div_0_ng_container_11_div_2_Template, 3, 0, \"div\", 10);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵtemplate(4, DetailsComponent_div_0_ng_container_11_div_4_Template, 3, 0, \"div\", 10);\n    i0.ɵɵpipe(5, \"async\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(3, 2, ctx_r1.canLike$) == 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(5, 4, ctx_r1.canLike$) != 0);\n  }\n}\nconst _c0 = function (a2) {\n  return [\"/cars\", \"edit\", a2];\n};\nfunction DetailsComponent_div_0_ng_container_34_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 15)(2, \"button\", 16);\n    i0.ɵɵtext(3, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function DetailsComponent_div_0_ng_container_34_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.removePost(ctx_r7.car._id));\n    });\n    i0.ɵɵtext(5, \"Delete\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(1, _c0, ctx_r2.car._id));\n  }\n}\nfunction DetailsComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"main\", 2)(2, \"div\", 3)(3, \"div\", 4)(4, \"div\", 5);\n    i0.ɵɵelement(5, \"img\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 7)(7, \"span\", 8);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"async\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"div\", 9);\n    i0.ɵɵtemplate(11, DetailsComponent_div_0_ng_container_11_Template, 6, 6, \"ng-container\", 10);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 11)(13, \"div\", 12)(14, \"div\")(15, \"h5\");\n    i0.ɵɵtext(16, \"BRAND\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"p\");\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"div\")(20, \"h5\");\n    i0.ɵɵtext(21, \"MODEL\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"p\");\n    i0.ɵɵtext(23);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(24, \"div\")(25, \"h5\");\n    i0.ɵɵtext(26, \"YEAR\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"p\");\n    i0.ɵɵtext(28);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(29, \"div\")(30, \"h5\");\n    i0.ɵɵtext(31, \"DESCRIPTION\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"p\");\n    i0.ɵɵtext(33);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(34, DetailsComponent_div_0_ng_container_34_Template, 6, 3, \"ng-container\", 10);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵpropertyInterpolate(\"src\", ctx_r0.car.imageUrl, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Likes: \", i0.ɵɵpipeBind1(9, 8, ctx_r0.likes$), \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.isOwner && ctx_r0.isLogged);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(ctx_r0.car.brand);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r0.car.model);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r0.car.year);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r0.car.description);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isOwner);\n  }\n}\nexport class DetailsComponent {\n  constructor(PostsService, authService, titleService, router, route) {\n    this.PostsService = PostsService;\n    this.authService = authService;\n    this.titleService = titleService;\n    this.router = router;\n    this.route = route;\n  }\n  ngOnInit() {\n    this.titleService.setTitle('Details');\n    this.isLogged = this.authService.isLogged;\n    const carId = this.route.snapshot.params['carId'];\n    this.userId = this.authService.getUserData()?._id;\n    this.likes$ = this.PostsService.postTotalLikes(carId);\n    this.canLike$ = this.PostsService.canLike(carId, this.userId);\n    this.subscribe$ = this.PostsService.getPostById(carId).subscribe({\n      next: carInfo => {\n        this.car = carInfo;\n        this.titleService.setTitle(this.car.brand);\n        this.isOwner = carInfo._ownerId == this.userId;\n      },\n      error: error => this.errorMessage = error.error.message\n    });\n  }\n  removePost(postId) {\n    const isConfirmed = window.confirm('Are you sure you want to delete this post?');\n    if (isConfirmed) {\n      this.subscribe$ = this.PostsService.deletePostById(postId).subscribe({\n        error: error => this.errorMessage = error.error.message,\n        complete: () => this.router.navigate(['catalog'])\n      });\n    }\n  }\n  postLike(postId) {\n    this.subscribe$ = this.PostsService.likePostById(postId).subscribe({\n      error: error => {\n        if (error.message.includes('Unknown Error')) {\n          this.errorMessage = 'Server not connected!';\n        } else {\n          this.errorMessage = error.error.message;\n        }\n      },\n      complete: () => {\n        this.canLike$ = this.PostsService.canLike(postId, this.userId);\n        this.likes$ = this.PostsService.postTotalLikes(postId);\n        // this.router.navigate(['/catalog', 'details', postId]);\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    if (this.subscribe$ != undefined) {\n      this.subscribe$.unsubscribe();\n    }\n  }\n  static #_ = this.ɵfac = function DetailsComponent_Factory(t) {\n    return new (t || DetailsComponent)(i0.ɵɵdirectiveInject(i1.PostsService), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.Title), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i4.ActivatedRoute));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: DetailsComponent,\n    selectors: [[\"app-details\"]],\n    decls: 1,\n    vars: 1,\n    consts: [[\"class\", \"detailsWrapper\", 4, \"ngIf\"], [1, \"detailsWrapper\"], [1, \"details-main\"], [1, \"cardInfo\"], [1, \"imageAndButtons\"], [1, \"details__image\"], [\"alt\", \"\", 1, \"current__img\", 3, \"src\"], [1, \"card__likes\"], [1, \"likesCount\"], [1, \"details__button\"], [4, \"ngIf\"], [1, \"details__info\"], [1, \"about__card\"], [\"href\", \"javascript:void(0)\", 1, \"detBtn\", 3, \"click\"], [\"href\", \"javascript:void(0)\", 1, \"msgAfterLike\"], [1, \"owner__buttons\"], [1, \"detBtn\", 3, \"routerLink\"]],\n    template: function DetailsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, DetailsComponent_div_0_Template, 35, 10, \"div\", 0);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.car);\n      }\n    },\n    dependencies: [i5.NgIf, i4.RouterLink, i5.AsyncPipe],\n    styles: [\".detailsWrapper[_ngcontent-%COMP%] {\\n    display: flex;\\n    flex-direction: column;\\n    min-height: 100%;\\n}\\n\\n.details-main[_ngcontent-%COMP%] {\\n    color: #fff;\\n    background: #01FFF9;\\n    background: conic-gradient(from 315deg, #01FFF9, #010101);\\n    padding: 2em;\\n    flex-grow: 1;\\n    display: flex;\\n    flex-direction: column;\\n    justify-content: center;\\n    gap: 50px;\\n    \\n\\n}\\n\\n\\n.cardInfo[_ngcontent-%COMP%] {\\n    display: flex;\\n    justify-content: center;\\n    gap: 2em;\\n    margin: 40px auto;\\n    height: 70vh;\\n    background-color: transparent;\\n    border: 2px solid rgba(255, 255, 255, .2);\\n    -webkit-backdrop-filter: blur(20px);\\n            backdrop-filter: blur(20px);\\n    box-shadow: 0 0 10px rgba(0, 0, 0, .2);\\n    color: #fff;\\n    border-radius: 10px;\\n    padding: 30px 40px;\\n    width: 900px;\\n}\\n\\n.details__image[_ngcontent-%COMP%] {\\n    width: 450px;\\n    margin-bottom: 2em;\\n    \\n\\n}\\n\\n.details__image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{\\n    width: 100%;\\n}\\n\\n.current__img[_ngcontent-%COMP%] {\\n    border-radius: 10px;\\n}\\n\\n.details__info[_ngcontent-%COMP%] {\\n    display: flex;\\n    flex-direction: column;\\n    justify-content: space-between;\\n    border-radius: 10px;\\n    padding: 40px;\\n    \\n\\n    width: 350px;\\n    background: #3b3b3ba1;\\n}\\n\\n.card__likes[_ngcontent-%COMP%] {\\n    display: flex;\\n    justify-content: center;\\n    gap: 1em;\\n    margin-bottom: 2em;\\n}\\n\\n.details__button[_ngcontent-%COMP%], .owner__buttons[_ngcontent-%COMP%] {\\n    display: flex;\\n    gap: 1em;\\n    justify-content: center;\\n}\\n\\n.guest__buttons[_ngcontent-%COMP%] {\\n    align-self: center;\\n    \\n\\n}\\n\\n.detBtn[_ngcontent-%COMP%] {\\n    text-decoration: none;\\n    padding: 8px 25px;\\n    border-radius: 100px;\\n    background-color: #01e5df;\\n    border: 0px solid #01e5df;\\n    color: #000;\\n}\\n\\n.msgAfterLike[_ngcontent-%COMP%] {\\n    text-decoration: none;\\n    color: #fff;\\n}\\n\\n.detBtn[_ngcontent-%COMP%]:hover {\\n    background-color: #000;\\n    color: #01e5df;\\n}\\n\\n.imageAndButtons[_ngcontent-%COMP%] {\\n    display: flex;\\n    flex-direction: column;\\n    justify-content: center;\\n}\\n\\n.about__card[_ngcontent-%COMP%] {\\n    display: flex;\\n    flex-direction: column;\\n    gap: 1em;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZmVhdHVyZXMvcG9zdHMvZGV0YWlscy9kZXRhaWxzLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLGdCQUFnQjtBQUNwQjs7QUFFQTtJQUNJLFdBQVc7SUFDWCxtQkFBbUI7SUFDbkIseURBQXlEO0lBQ3pELFlBQVk7SUFDWixZQUFZO0lBQ1osYUFBYTtJQUNiLHNCQUFzQjtJQUN0Qix1QkFBdUI7SUFDdkIsU0FBUztJQUNULHVCQUF1QjtBQUMzQjs7O0FBR0E7SUFDSSxhQUFhO0lBQ2IsdUJBQXVCO0lBQ3ZCLFFBQVE7SUFDUixpQkFBaUI7SUFDakIsWUFBWTtJQUNaLDZCQUE2QjtJQUM3Qix5Q0FBeUM7SUFDekMsbUNBQTJCO1lBQTNCLDJCQUEyQjtJQUMzQixzQ0FBc0M7SUFDdEMsV0FBVztJQUNYLG1CQUFtQjtJQUNuQixrQkFBa0I7SUFDbEIsWUFBWTtBQUNoQjs7QUFFQTtJQUNJLFlBQVk7SUFDWixrQkFBa0I7SUFDbEIsb0JBQW9CO0FBQ3hCOztBQUVBO0lBQ0ksV0FBVztBQUNmOztBQUVBO0lBQ0ksbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0ksYUFBYTtJQUNiLHNCQUFzQjtJQUN0Qiw4QkFBOEI7SUFDOUIsbUJBQW1CO0lBQ25CLGFBQWE7SUFDYixrQkFBa0I7SUFDbEIsWUFBWTtJQUNaLHFCQUFxQjtBQUN6Qjs7QUFFQTtJQUNJLGFBQWE7SUFDYix1QkFBdUI7SUFDdkIsUUFBUTtJQUNSLGtCQUFrQjtBQUN0Qjs7QUFFQTs7SUFFSSxhQUFhO0lBQ2IsUUFBUTtJQUNSLHVCQUF1QjtBQUMzQjs7QUFFQTtJQUNJLGtCQUFrQjtJQUNsQixzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSxxQkFBcUI7SUFDckIsaUJBQWlCO0lBQ2pCLG9CQUFvQjtJQUNwQix5QkFBeUI7SUFDekIseUJBQXlCO0lBQ3pCLFdBQVc7QUFDZjs7QUFFQTtJQUNJLHFCQUFxQjtJQUNyQixXQUFXO0FBQ2Y7O0FBRUE7SUFDSSxzQkFBc0I7SUFDdEIsY0FBYztBQUNsQjs7QUFFQTtJQUNJLGFBQWE7SUFDYixzQkFBc0I7SUFDdEIsdUJBQXVCO0FBQzNCOztBQUVBO0lBQ0ksYUFBYTtJQUNiLHNCQUFzQjtJQUN0QixRQUFRO0FBQ1oiLCJzb3VyY2VzQ29udGVudCI6WyIuZGV0YWlsc1dyYXBwZXIge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgICBtaW4taGVpZ2h0OiAxMDAlO1xyXG59XHJcblxyXG4uZGV0YWlscy1tYWluIHtcclxuICAgIGNvbG9yOiAjZmZmO1xyXG4gICAgYmFja2dyb3VuZDogIzAxRkZGOTtcclxuICAgIGJhY2tncm91bmQ6IGNvbmljLWdyYWRpZW50KGZyb20gMzE1ZGVnLCAjMDFGRkY5LCAjMDEwMTAxKTtcclxuICAgIHBhZGRpbmc6IDJlbTtcclxuICAgIGZsZXgtZ3JvdzogMTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgICBnYXA6IDUwcHg7XHJcbiAgICAvKiBtaW4taGVpZ2h0OiAxMDB2aDsgKi9cclxufVxyXG5cclxuXHJcbi5jYXJkSW5mbyB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgICBnYXA6IDJlbTtcclxuICAgIG1hcmdpbjogNDBweCBhdXRvO1xyXG4gICAgaGVpZ2h0OiA3MHZoO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XHJcbiAgICBib3JkZXI6IDJweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIC4yKTtcclxuICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigyMHB4KTtcclxuICAgIGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoMCwgMCwgMCwgLjIpO1xyXG4gICAgY29sb3I6ICNmZmY7XHJcbiAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xyXG4gICAgcGFkZGluZzogMzBweCA0MHB4O1xyXG4gICAgd2lkdGg6IDkwMHB4O1xyXG59XHJcblxyXG4uZGV0YWlsc19faW1hZ2Uge1xyXG4gICAgd2lkdGg6IDQ1MHB4O1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMmVtO1xyXG4gICAgLyogbWFyZ2luOiAwIGF1dG87ICovXHJcbn1cclxuXHJcbi5kZXRhaWxzX19pbWFnZSBpbWd7XHJcbiAgICB3aWR0aDogMTAwJTtcclxufVxyXG5cclxuLmN1cnJlbnRfX2ltZyB7XHJcbiAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xyXG59XHJcblxyXG4uZGV0YWlsc19faW5mbyB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxuICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7XHJcbiAgICBwYWRkaW5nOiA0MHB4O1xyXG4gICAgLyogaGVpZ2h0OiAzOHZoOyAqL1xyXG4gICAgd2lkdGg6IDM1MHB4O1xyXG4gICAgYmFja2dyb3VuZDogIzNiM2IzYmExO1xyXG59XHJcblxyXG4uY2FyZF9fbGlrZXMge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgZ2FwOiAxZW07XHJcbiAgICBtYXJnaW4tYm90dG9tOiAyZW07XHJcbn1cclxuXHJcbi5kZXRhaWxzX19idXR0b24sXHJcbi5vd25lcl9fYnV0dG9ucyB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZ2FwOiAxZW07XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxufVxyXG5cclxuLmd1ZXN0X19idXR0b25zIHtcclxuICAgIGFsaWduLXNlbGY6IGNlbnRlcjtcclxuICAgIC8qIG1hcmdpbi10b3A6IDIwcHg7ICovXHJcbn1cclxuXHJcbi5kZXRCdG4ge1xyXG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gICAgcGFkZGluZzogOHB4IDI1cHg7XHJcbiAgICBib3JkZXItcmFkaXVzOiAxMDBweDtcclxuICAgIGJhY2tncm91bmQtY29sb3I6ICMwMWU1ZGY7XHJcbiAgICBib3JkZXI6IDBweCBzb2xpZCAjMDFlNWRmO1xyXG4gICAgY29sb3I6ICMwMDA7XHJcbn1cclxuXHJcbi5tc2dBZnRlckxpa2Uge1xyXG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gICAgY29sb3I6ICNmZmY7XHJcbn1cclxuXHJcbi5kZXRCdG46aG92ZXIge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzAwMDtcclxuICAgIGNvbG9yOiAjMDFlNWRmO1xyXG59XHJcblxyXG4uaW1hZ2VBbmRCdXR0b25zIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbn1cclxuXHJcbi5hYm91dF9fY2FyZCB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgIGdhcDogMWVtO1xyXG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵlistener","DetailsComponent_div_0_ng_container_11_div_2_Template_a_click_1_listener","ɵɵrestoreView","_r6","ctx_r5","ɵɵnextContext","ɵɵresetView","postLike","car","_id","ɵɵtext","ɵɵelementEnd","ɵɵelementContainerStart","ɵɵtemplate","DetailsComponent_div_0_ng_container_11_div_2_Template","DetailsComponent_div_0_ng_container_11_div_4_Template","ɵɵelementContainerEnd","ɵɵadvance","ɵɵproperty","ɵɵpipeBind1","ctx_r1","canLike$","DetailsComponent_div_0_ng_container_34_Template_button_click_4_listener","_r8","ctx_r7","removePost","ɵɵpureFunction1","_c0","ctx_r2","ɵɵelement","DetailsComponent_div_0_ng_container_11_Template","DetailsComponent_div_0_ng_container_34_Template","ɵɵpropertyInterpolate","ctx_r0","imageUrl","ɵɵsanitizeUrl","ɵɵtextInterpolate1","likes$","isOwner","isLogged","ɵɵtextInterpolate","brand","model","year","description","DetailsComponent","constructor","PostsService","authService","titleService","router","route","ngOnInit","setTitle","carId","snapshot","params","userId","getUserData","postTotalLikes","canLike","subscribe$","getPostById","subscribe","next","carInfo","_ownerId","error","errorMessage","message","postId","isConfirmed","window","confirm","deletePostById","complete","navigate","likePostById","includes","ngOnDestroy","undefined","unsubscribe","_","ɵɵdirectiveInject","i1","i2","AuthService","i3","Title","i4","Router","ActivatedRoute","_2","selectors","decls","vars","consts","template","DetailsComponent_Template","rf","ctx","DetailsComponent_div_0_Template"],"sources":["C:\\Users\\vikoa\\OneDrive\\Работен плот\\Angular prject\\carWeb\\src\\app\\features\\posts\\details\\details.component.ts","C:\\Users\\vikoa\\OneDrive\\Работен плот\\Angular prject\\carWeb\\src\\app\\features\\posts\\details\\details.component.html"],"sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { Observable, Subscription } from 'rxjs';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport { PostInterface } from 'src/app/core/interfaces/Post';\nimport { PostsService } from 'src/app/core/services/posts.service';\nimport { AuthService } from 'src/app/core/services/auth.service';\nimport { Title } from '@angular/platform-browser';\n\n@Component({\n  selector: 'app-details',\n  templateUrl: './details.component.html',\n  styleUrls: ['./details.component.css']\n})\n\nexport class DetailsComponent implements OnInit, OnDestroy {\n  car!: PostInterface;\n  subscribe$!: Subscription;\n  errorMessage!: string;\n\n  isOwner!: boolean;\n  isLogged!: boolean;\n  userId!: string;\n  canLike$!: Observable<number>;\n  likes$!: Observable<number>;\n\n  constructor(\n    private PostsService: PostsService,\n    private authService: AuthService,\n    private titleService: Title,\n    private router: Router,\n    private route: ActivatedRoute,) { }\n\n  ngOnInit(): void {\n    this.titleService.setTitle('Details');\n    this.isLogged = this.authService.isLogged;\n\n    const carId: string = this.route.snapshot.params['carId'];\n    \n    this.userId = this.authService.getUserData()?._id as string;\n    this.likes$ = this.PostsService.postTotalLikes(carId);\n    this.canLike$ = this.PostsService.canLike(carId, this.userId);\n\n    this.subscribe$ = this.PostsService.getPostById(carId).subscribe({\n      next: (carInfo) => {\n        this.car = carInfo;\n        this.titleService.setTitle(this.car.brand);\n        this.isOwner = carInfo._ownerId == this.userId;\n      },\n      error: (error) => this.errorMessage = error.error.message\n    });\n  }\n\n  removePost(postId: string) {\n\n    const isConfirmed = window.confirm('Are you sure you want to delete this post?');\n\n    if (isConfirmed) {\n      this.subscribe$ = this.PostsService.deletePostById(postId).subscribe({\n        error: (error) => this.errorMessage = error.error.message,\n        complete: () => this.router.navigate(['catalog'])\n      });\n    }\n\n  }\n\n  postLike(postId: string) {\n    this.subscribe$ = this.PostsService.likePostById(postId).subscribe({\n      error: (error) => {\n        if (error.message.includes('Unknown Error')) {\n          this.errorMessage = 'Server not connected!'\n        } else {\n          this.errorMessage = error.error.message;\n        }\n      },\n      complete: () => {\n        this.canLike$ = this.PostsService.canLike(postId, this.userId);\n        this.likes$ = this.PostsService.postTotalLikes(postId);\n        // this.router.navigate(['/catalog', 'details', postId]);\n      },\n    });\n    \n  }\n\n  ngOnDestroy(): void {\n    if (this.subscribe$ != undefined) {\n      this.subscribe$.unsubscribe();\n    }\n  }\n}","<div class=\"detailsWrapper\" *ngIf=\"car\">\n    <main class=\"details-main\">\n        <div class=\"cardInfo\">\n            <div class=\"imageAndButtons\">\n                <div class=\"details__image\">\n                    <img class=\"current__img\" src=\"{{ car.imageUrl}}\" alt=\"\">\n                </div>\n                <div class=\"card__likes\">\n                    <span class=\"likesCount\">Likes: {{ likes$ | async }}</span>\n                </div>\n                <div class=\"details__button\">\n                    <ng-container *ngIf=\"!isOwner && isLogged\">\n                        <div >\n                          <div *ngIf=\"(canLike$ | async) == 0\">\n                            <a href=\"javascript:void(0)\" (click)=\"postLike(car._id)\" class=\"detBtn\">\n                              Like\n                            </a>\n                          </div>\n                \n                          <div *ngIf=\"(canLike$ | async) != 0\">\n                            <a href=\"javascript:void(0)\" class=\"msgAfterLike\">\n                              You have already liked this post!\n                            </a>\n                          </div>\n                \n                        </div>\n                      </ng-container>\n                   \n                </div>\n            </div>\n            <div class=\"details__info\">\n                <div class=\"about__card\">\n                    <div>\n                        <h5>BRAND</h5>\n                        <p>{{ car.brand }}</p>\n                    </div>\n\n                    <div>\n                        <h5>MODEL</h5>\n                        <p>{{ car.model }}</p>\n                    </div>\n\n                    <div>\n                        <h5>YEAR</h5>\n                        <p>{{ car.year }}</p>\n                    </div>\n\n                    <div>\n                        <h5>DESCRIPTION</h5>\n                        <p>{{ car.description }}</p>\n                    </div>\n\n                    <!-- <div>\n                        <h5>AUTHOR</h5>\n                        <p>{{ car.author }}</p>\n                    </div> -->\n\n                    \n                </div>\n                \n                <ng-container *ngIf=\"isOwner\">\n                    <div class=\"owner__buttons\">\n                        <button class=\"detBtn\" [routerLink]=\"['/cars', 'edit', car._id]\">Edit</button>\n                        <button class=\"detBtn\" href=\"javascript:void(0)\" (click)=\"removePost(car._id)\">Delete</button>\n                    </div>\n                </ng-container>\n\n                \n            </div>\n        </div>\n    </main>\n</div>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}