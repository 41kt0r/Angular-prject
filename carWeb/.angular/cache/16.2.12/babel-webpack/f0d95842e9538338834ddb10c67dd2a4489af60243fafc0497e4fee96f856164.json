{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nexport let CreateComponent = class CreateComponent {\n  constructor(PostsService, titleService, router, authService) {\n    this.PostsService = PostsService;\n    this.titleService = titleService;\n    this.router = router;\n    this.authService = authService;\n  }\n  ngOnInit() {\n    this.titleService.setTitle('Create');\n  }\n  createMethod(formData) {\n    const userId = this.authService.getUserData()?._id;\n    const userInput = formData.value;\n    userInput._ownerId = userId;\n    this.PostsService.getAllPosts().subscribe({\n      next: posts => {\n        const episodeExists = posts.some(posts => posts.brand === userInput.brand);\n        if (episodeExists) {\n          this.errorMessage = 'Post with this name already exists.';\n        } else {\n          this.subscribe$ = this.PostsService.addPost(userInput).subscribe({\n            next: () => this.router.navigate(['/catalog']),\n            error: error => this.errorMessage = error.error.message\n          });\n        }\n      },\n      error: error => {\n        if (error.message.includes('Unknown Error')) {\n          this.errorMessage = 'Server not connected!';\n        } else {\n          this.errorMessage = error.error.message;\n        }\n      }\n    });\n  }\n  ngOnDestroy() {\n    if (this.subscribe$ != undefined) {\n      this.subscribe$.unsubscribe();\n    }\n  }\n};\nCreateComponent = __decorate([Component({\n  selector: 'app-create',\n  templateUrl: './create.component.html',\n  styleUrls: ['./create.component.css']\n})], CreateComponent);","map":{"version":3,"names":["Component","CreateComponent","constructor","PostsService","titleService","router","authService","ngOnInit","setTitle","createMethod","formData","userId","getUserData","_id","userInput","value","_ownerId","getAllPosts","subscribe","next","posts","episodeExists","some","brand","errorMessage","subscribe$","addPost","navigate","error","message","includes","ngOnDestroy","undefined","unsubscribe","__decorate","selector","templateUrl","styleUrls"],"sources":["D:\\SoftUni\\Angular pj\\car-web\\src\\app\\features\\posts\\create\\create.component.ts"],"sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { NgForm } from '@angular/forms';\nimport { Title } from '@angular/platform-browser';\nimport { Router } from '@angular/router';\nimport { Subscription } from 'rxjs';\nimport { PostInterface } from 'src/app/core/interfaces/Post';\nimport { AuthService } from 'src/app/core/services/auth.service';\nimport { PostsService } from 'src/app/core/services/posts.service';\n\n\n@Component({\n  selector: 'app-create',\n  templateUrl: './create.component.html',\n  styleUrls: ['./create.component.css'],\n})\nexport class CreateComponent implements OnInit, OnDestroy {\n  subscribe$!: Subscription;\n  errorMessage!: string;\n\n  constructor(\n    private PostsService: PostsService,\n    private titleService: Title,\n    private router: Router,\n    private authService: AuthService\n  ) {}\n\n  ngOnInit(): void {\n    this.titleService.setTitle('Create');\n  }\n\n  createMethod(formData: NgForm) {\n    const userId = this.authService.getUserData()?._id;\n    const userInput = formData.value;\n    userInput._ownerId = userId;\n\n    this.PostsService.getAllPosts().subscribe({\n      next: (posts: PostInterface[]) => {\n        \n        const episodeExists = posts.some(posts => posts.brand === userInput.brand);\n        if (episodeExists) {\n          this.errorMessage = 'Post with this name already exists.';\n        } else {\n          this.subscribe$ = this.PostsService.addPost(userInput).subscribe({\n            next: () => this.router.navigate(['/catalog']),\n            error: (error) => this.errorMessage = error.error.message,\n          });\n        }\n      },\n      error: (error) => {\n        if (error.message.includes('Unknown Error')) {\n          this.errorMessage = 'Server not connected!'\n        } else {\n          this.errorMessage = error.error.message;\n        }\n      }\n    });\n  }\n  ngOnDestroy(): void {\n    if (this.subscribe$ != undefined) {\n      this.subscribe$.unsubscribe();\n    }\n  }\n}"],"mappings":";AAAA,SAASA,SAAS,QAA2B,eAAe;AAerD,WAAMC,eAAe,GAArB,MAAMA,eAAe;EAI1BC,YACUC,YAA0B,EAC1BC,YAAmB,EACnBC,MAAc,EACdC,WAAwB;IAHxB,KAAAH,YAAY,GAAZA,YAAY;IACZ,KAAAC,YAAY,GAAZA,YAAY;IACZ,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,WAAW,GAAXA,WAAW;EAClB;EAEHC,QAAQA,CAAA;IACN,IAAI,CAACH,YAAY,CAACI,QAAQ,CAAC,QAAQ,CAAC;EACtC;EAEAC,YAAYA,CAACC,QAAgB;IAC3B,MAAMC,MAAM,GAAG,IAAI,CAACL,WAAW,CAACM,WAAW,EAAE,EAAEC,GAAG;IAClD,MAAMC,SAAS,GAAGJ,QAAQ,CAACK,KAAK;IAChCD,SAAS,CAACE,QAAQ,GAAGL,MAAM;IAE3B,IAAI,CAACR,YAAY,CAACc,WAAW,EAAE,CAACC,SAAS,CAAC;MACxCC,IAAI,EAAGC,KAAsB,IAAI;QAE/B,MAAMC,aAAa,GAAGD,KAAK,CAACE,IAAI,CAACF,KAAK,IAAIA,KAAK,CAACG,KAAK,KAAKT,SAAS,CAACS,KAAK,CAAC;QAC1E,IAAIF,aAAa,EAAE;UACjB,IAAI,CAACG,YAAY,GAAG,qCAAqC;SAC1D,MAAM;UACL,IAAI,CAACC,UAAU,GAAG,IAAI,CAACtB,YAAY,CAACuB,OAAO,CAACZ,SAAS,CAAC,CAACI,SAAS,CAAC;YAC/DC,IAAI,EAAEA,CAAA,KAAM,IAAI,CAACd,MAAM,CAACsB,QAAQ,CAAC,CAAC,UAAU,CAAC,CAAC;YAC9CC,KAAK,EAAGA,KAAK,IAAK,IAAI,CAACJ,YAAY,GAAGI,KAAK,CAACA,KAAK,CAACC;WACnD,CAAC;;MAEN,CAAC;MACDD,KAAK,EAAGA,KAAK,IAAI;QACf,IAAIA,KAAK,CAACC,OAAO,CAACC,QAAQ,CAAC,eAAe,CAAC,EAAE;UAC3C,IAAI,CAACN,YAAY,GAAG,uBAAuB;SAC5C,MAAM;UACL,IAAI,CAACA,YAAY,GAAGI,KAAK,CAACA,KAAK,CAACC,OAAO;;MAE3C;KACD,CAAC;EACJ;EACAE,WAAWA,CAAA;IACT,IAAI,IAAI,CAACN,UAAU,IAAIO,SAAS,EAAE;MAChC,IAAI,CAACP,UAAU,CAACQ,WAAW,EAAE;;EAEjC;CACD;AA/CYhC,eAAe,GAAAiC,UAAA,EAL3BlC,SAAS,CAAC;EACTmC,QAAQ,EAAE,YAAY;EACtBC,WAAW,EAAE,yBAAyB;EACtCC,SAAS,EAAE,CAAC,wBAAwB;CACrC,CAAC,C,EACWpC,eAAe,CA+C3B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}